{% extends "base.html" %}
{% block content %}
<h1>Your cart</h1>

{% if cart|length == 0 %}
  <p>Your cart is empty.</p>
{% else %}
  <table class="table">
    <thead>
      <tr><th>Product</th><th>Price</th><th>Qty</th><th>Total</th><th></th></tr>
    </thead>
    <tbody>
      {% for item in cart %}
        <tr>
          <td>{{ item.product.name }}</td>
          <td>${{ item.price }}</td>
          <td>
            <form method="post" action="{% url 'store:add_to_cart' item.product.id %}" class="d-inline">
              {% csrf_token %}
              <input type="number" name="quantity" value="{{ item.quantity }}" min="1" style="width:80px" class="form-control d-inline-block me-2">
              <input type="hidden" name="update" value="true">
              <button class="btn btn-sm btn-secondary">Update</button>
            </form>
          </td>
          <td>${{ item.total_price }}</td>
          <td>
            <form method="post" action="{% url 'store:remove_from_cart' item.product.id %}">
              {% csrf_token %}
              <button class="btn btn-sm btn-danger">Remove</button>
            </form>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <p><strong>Total: ${{ cart.get_total_price }}</strong></p>
  <a class="btn btn-success">Checkout (not implemented)</a>
{% endif %}
{% endblock %}
